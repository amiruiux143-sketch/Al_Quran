<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Al-Qur'an Ultimate Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #ffffff; --header: #fbfbfb; --gold: #b2904f; --line: #f0f0f0; --text: #000; --fz-ar: 32px; }
        body.dark-mode { --bg: #121212; --header: #1e1e1e; --line: #333; --text: #eee; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { background: var(--bg); font-family: 'Montserrat', sans-serif; margin: 0; padding-bottom: 80px; color: var(--text); transition: 0.3s; overflow-x: hidden; }

        /* Splash Screen */
        #splash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 5000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 1s; color: white; }
        .bism-text { font-family: 'Amiri', serif; font-size: 36px; color: var(--gold); text-shadow: 0 0 15px rgba(178,144,79,0.5); }

        /* Header */
        .main-header { position: sticky; top: 0; z-index: 1000; background: var(--header); padding: 15px; border-bottom: 1px solid var(--line); }
        .main-header h1 { font-size: 22px; margin: 0; font-weight: 700; color: var(--gold); }
        #surahSearch { width: 100%; padding: 12px; border-radius: 12px; border: none; background: #f0f0f0; margin-top: 10px; font-size: 14px; }

        /* Pages */
        .page-sec { display: none; padding: 10px; animation: fadeIn 0.4s; }
        .page-sec.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* –°–ø–∏—Å–∫–∏ */
        .item { display: flex; align-items: center; padding: 18px 10px; border-bottom: 1px solid var(--line); cursor: pointer; transition: 0.2s; }
        .item:active { background: rgba(178,144,79,0.1); }
        .num { color: var(--gold); font-size: 14px; width: 40px; font-weight: bold; }
        .ar-name { font-size: 24px; color: var(--gold); font-family: 'Amiri', serif; margin-left: auto; }

        /* –ê–ù–ò–ú–ê–¶–ò–ò –ö–ù–û–ü–û–ö */
        @keyframes pulse-playing {
            0% { box-shadow: 0 0 0 0 rgba(178, 144, 79, 0.6); }
            70% { box-shadow: 0 0 0 10px rgba(178, 144, 79, 0); }
            100% { box-shadow: 0 0 0 0 rgba(178, 144, 79, 0); }
        }

        .audio-btn { 
            margin-top: 15px; background: var(--gold); color: white; border: none; 
            padding: 10px 22px; border-radius: 25px; font-weight: bold; 
            cursor: pointer; transition: 0.3s; font-size: 13px;
            display: inline-flex; align-items: center; gap: 8px;
        }
        .audio-btn:active { transform: scale(0.92); }
        
        /* –ö–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–∏—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–∏ */
        .audio-btn.playing { 
            animation: pulse-playing 1.5s infinite; 
            background: #d4af37;
        }

        /* GPS –ö–Ω–æ–ø–∫–∞ */
        .gps-btn { 
            width: 100%; padding: 16px; border-radius: 15px; border: none; 
            background: linear-gradient(45deg, #b2904f, #d4af37); color: white; 
            font-weight: bold; cursor: pointer; font-size: 14px;
        }
        .gps-btn.loading { animation: pulse-playing 1.5s infinite; opacity: 0.7; }

        .prayer-card { background: var(--header); border-radius: 20px; padding: 25px; border: 1px solid var(--line); text-align: center; }
        .prayer-row { display: flex; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid var(--line); font-weight: 600; }

        /* –û–∫–Ω–æ —Å—É—Ä—ã */
        .window { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 2000; overflow-y: auto; }
        .window-header { position: sticky; top: 0; background: var(--header); height: 60px; display: flex; align-items: center; padding: 0 15px; border-bottom: 1px solid var(--line); }
        .close-btn { font-size: 24px; color: var(--gold); border: none; background: none; }

        .ayah-box { padding: 25px 20px; border-bottom: 1px solid var(--line); }
        .ar-text { direction: rtl; font-family: 'Amiri', serif; font-size: var(--fz-ar); line-height: 2.1; text-align: right; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: var(--header); display: flex; border-top: 1px solid var(--line); z-index: 1500; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 11px; color: #888; }
        .nav-item.active { color: var(--gold); font-weight: bold; }
    </style>
</head>
<body class="dark-mode">

<div id="splash">
    <div class="bism-text">ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸëŸéŸáŸê ÿßŸÑÿ±ŸëŸéÿ≠ŸíŸÖŸéŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê</div>
    <div style="margin-top:10px; font-size: 10px; letter-spacing: 3px; color: #555;">AL-QUR'AN PRO</div>
</div>

<header class="main-header">
    <div style="display:flex; justify-content: space-between; align-items: center;">
        <h1 id="pageTitle">–ö–æ—Ä–∞–Ω</h1>
        <span style="font-weight: bold; color: var(--gold); font-size: 12px; border: 1px solid var(--gold); padding: 2px 5px; border-radius: 5px;">RU</span>
    </div>
    <input type="text" id="surahSearch" placeholder="–ü–æ–∏—Å–∫ —Å—É—Ä—ã..." onkeyup="filterSurahs()">
</header>

<div id="quranSec" class="page-sec active"><div id="surahList"></div></div>
<div id="namesSec" class="page-sec"><div id="namesList"></div></div>
<div id="prayerSec" class="page-sec">
    <div class="prayer-card">
        <button class="gps-btn" id="gpsBtn" onclick="getGPS()">üìç –û–ü–†–ï–î–ï–õ–ò–¢–¨ –í–†–ï–ú–Ø –ù–ê–ú–ê–ó–ê</button>
        <div id="cityName" style="font-size: 12px; opacity: 0.6; margin: 15px 0;">–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫ GPS</div>
        <div id="hijriDate" style="color: var(--gold); font-weight: bold; margin-bottom: 15px;"></div>
        <div id="prayerContent"></div>
    </div>
</div>
<div id="settingsSec" class="page-sec">
    <div class="prayer-card" style="text-align: left;">
        <h3 style="color:var(--gold); margin:0 0 15px 0;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div style="display:flex; justify-content: space-between; margin-bottom: 20px;">
            <span>–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</span>
            <input type="checkbox" checked onchange="document.body.classList.toggle('dark-mode')">
        </div>
        <span>–†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞:</span>
        <input type="range" min="24" max="50" value="32" style="width:100%; margin-top:10px; accent-color: var(--gold);" oninput="document.documentElement.style.setProperty('--fz-ar', this.value + 'px')">
    </div>
</div>

<div id="surahWin" class="window">
    <div class="window-header"><button class="close-btn" onclick="closeSurah()">‚úï</button><h2 id="winTitle" style="flex:1; text-align:center; font-size:16px;"></h2></div>
    <div id="winContent"></div>
</div>

<nav class="nav">
    <div class="nav-item active" onclick="showPage('quran', this, '–ö–æ—Ä–∞–Ω')"><span>üìñ</span>–ö–æ—Ä–∞–Ω</div>
    <div class="nav-item" onclick="showPage('names', this, '99 –ò–º–µ–Ω')"><span>‚ú®</span>–ò–º–µ–Ω–∞</div>
    <div class="nav-item" onclick="showPage('prayer', this, '–ù–∞–º–∞–∑')"><span>üïå</span>–ù–∞–º–∞–∑</div>
    <div class="nav-item" onclick="showPage('settings', this, '–û–ø—Ü–∏–∏')"><span>‚öôÔ∏è</span>–û–ø—Ü–∏–∏</div>
</nav>

<script>
let allSurahs = [];
const audio = new Audio();
let currentBtn = null; // –•—Ä–∞–Ω–∏–º —Ç–µ–∫—É—â—É—é –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É

function showPage(p, el, title) {
    document.querySelectorAll('.page-sec, .nav-item').forEach(x => x.classList.remove('active'));
    document.getElementById(p + 'Sec').classList.add('active');
    el.classList.add('active');
    document.getElementById('pageTitle').innerText = title;
    document.getElementById('surahSearch').style.display = (p === 'quran') ? 'block' : 'none';
}

async function init() {
    setTimeout(() => { document.getElementById('splash').style.opacity = '0'; setTimeout(() => document.getElementById('splash').remove(), 1000); }, 2000);
    const res = await fetch("https://api.alquran.cloud/v1/surah");
    const data = await res.json();
    allSurahs = data.data;
    renderSurahs(allSurahs);
    renderNames();
}

function renderSurahs(list) {
    document.getElementById('surahList').innerHTML = list.map(s => `
        <div class="item" onclick="openSurah(${s.number}, '${s.englishName}')">
            <div class="num">${s.number}</div>
            <div class="info"><b>${s.englishName}</b></div>
            <div class="ar-name">${s.name}</div>
        </div>`).join('');
}

function renderNames() {
    const names = [{ar:"ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸÜŸè", tr:"Ar-Rahman", ru:"–ú–∏–ª–æ—Å—Ç–∏–≤—ã–π"}, {ar:"ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸè", tr:"Ar-Rahim", ru:"–ú–∏–ª–æ—Å–µ—Ä–¥–Ω—ã–π"}];
    document.getElementById('namesList').innerHTML = names.map((n, i) => `
        <div class="item"><div class="num">${i+1}</div><div class="info"><b>${n.tr}</b><br><small>${n.ru}</small></div><div class="ar-name" style="font-size:20px;">${n.ar}</div></div>`).join('');
}

async function openSurah(id, name) {
    document.getElementById('surahWin').style.display = 'block';
    document.getElementById('winTitle').innerText = name;
    const res = await fetch(`https://api.alquran.cloud/v1/surah/${id}/editions/quran-uthmani,ru.kuliev`);
    const d = await res.json();
    document.getElementById('winContent').innerHTML = d.data[0].ayahs.map((a, i) => `
        <div class="ayah-box">
            <div class="ar-text">${a.text}</div>
            <div style="margin:15px 0; opacity:0.8;"><b>${i+1}.</b> ${d.data[1].ayahs[i].text}</div>
            <button class="audio-btn" onclick="playAudio(${a.number}, this)">
                <span class="icon">‚ñ∂</span> <span class="txt">–°–ª—É—à–∞—Ç—å —á—Ç–µ–Ω–∏–µ</span>
            </button>
        </div>`).join('');
}

function playAudio(num, btn) {
    // –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ —Ç–∞ –∂–µ –∫–Ω–æ–ø–∫–∞, —á—Ç–æ —Å–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç ‚Äî —Å—Ç–∞–≤–∏–º –Ω–∞ –ø–∞—É–∑—É
    if (currentBtn === btn && !audio.paused) {
        audio.pause();
        resetBtn(btn);
        return;
    }

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –±—ã–ª–∞
    if (currentBtn) resetBtn(currentBtn);

    currentBtn = btn;
    btn.classList.add('playing');
    btn.querySelector('.icon').innerText = "üîä";
    btn.querySelector('.txt').innerText = "–ò–≥—Ä–∞–µ—Ç...";

    audio.src = `https://cdn.islamic.network/quran/audio/128/ar.alafasy/${num}.mp3`;
    audio.play();

    audio.onended = () => resetBtn(btn);
}

function resetBtn(btn) {
    btn.classList.remove('playing');
    btn.querySelector('.icon').innerText = "‚ñ∂";
    btn.querySelector('.txt').innerText = "–°–ª—É—à–∞—Ç—å —á—Ç–µ–Ω–∏–µ";
    currentBtn = null;
}

function closeSurah() {
    document.getElementById('surahWin').style.display = 'none';
    audio.pause();
    if (currentBtn) resetBtn(currentBtn);
}

function filterSurahs() {
    const q = document.getElementById('surahSearch').value.toLowerCase();
    renderSurahs(allSurahs.filter(s => s.englishName.toLowerCase().includes(q) || s.number == q));
}

function getGPS() {
    const btn = document.getElementById('gpsBtn');
    btn.classList.add('loading');
    btn.innerText = "üîç –ü–û–ò–°–ö...";
    navigator.geolocation.getCurrentPosition(async (pos) => {
        btn.style.display = "none";
        const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&method=3`);
        const d = await res.json();
        const t = d.data.timings;
        const n = { Fajr: "–§–∞–¥–∂—Ä", Sunrise: "–í–æ—Å—Ö–æ–¥", Dhuhr: "–ó—É—Ö—Ä", Asr: "–ê—Å—Ä", Maghrib: "–ú–∞–≥—Ä–∏–±", Isha: "–ò—à–∞" };
        document.getElementById('hijriDate').innerText = `${d.data.date.hijri.day} ${d.data.date.hijri.month.en} ${d.data.date.hijri.year}`;
        document.getElementById('prayerContent').innerHTML = Object.keys(n).map(k => `
            <div class="prayer-row"><span>${n[k]}</span><span style="color:var(--gold)">${t[k]}</span></div>
        `).join('');
    }, () => { btn.classList.remove('loading'); btn.innerText = "üìç –û–®–ò–ë–ö–ê GPS"; });
}

init();
</script>
</body>
</html>

