<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Коран и Сунна Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root { --bg: #f8f9fa; --gold: #b2904f; --dark: #2c3e50; --red: #e74c3c; --green: #27ae60; --blue: #1e3a8a; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); font-family: 'Montserrat', sans-serif; overflow: hidden; color: var(--dark); }
        
        header { background: #fff; padding: 0 15px; display: flex; align-items: center; justify-content: center; height: 60px; border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 1000; }
        #tit { font-weight: 800; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }

        main { height: calc(100vh - 135px); overflow-y: auto; padding: 15px; max-width: 800px; margin: 0 auto; }
        .p { display: none; padding-bottom: 100px; }
        .p.active { display: block; }

        .search-box { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid #ddd; margin-bottom: 15px; font-family: inherit; font-size: 15px; }
        
        .grid-main { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: #fff; border-radius: 15px; padding: 25px; display: flex; flex-direction: column; align-items: center; border: 1px solid #eee; cursor: pointer; }
        .card i { font-size: 30px; color: var(--gold); margin-bottom: 10px; }

        .list-item { 
            background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 10px; 
            display: flex; justify-content: space-between; align-items: center; border: 1px solid #eee;
        }

        .win { display: none; position: fixed; inset: 0; background: #fff; z-index: 4000; overflow-y: auto; }
        .win-head { position: sticky; top: 0; background: #fff; height: 60px; display: flex; align-items: center; padding: 0 15px; border-bottom: 1px solid #eee; z-index: 4100; justify-content: space-between; }
        #wc { padding-bottom: 150px; } 

        .art { direction: rtl; font-family: 'Amiri', serif; font-size: 30px; line-height: 2.3; text-align: right; padding: 15px; }
        .sup-num { color: var(--gold); font-size: 18px; margin-left: 8px; border: 1px solid #eee; border-radius: 50%; padding: 0 8px; }
        .rut { font-size: 16px; color: #555; padding: 0 15px 15px; border-left: 3px solid var(--gold); margin: 5px 15px 10px; }

        /* ТАФСИР БЛОК */
        .taf-box { display: none; background: #f0f4f8; padding: 15px; border-radius: 10px; font-size: 14px; margin: 0 15px 15px; border-left: 4px solid var(--blue); line-height: 1.6; color: #333; }

        /* МАЛЕНЬКИЕ СВЕТЛЫЕ КНОПКИ */
        .btns-row { display: flex; gap: 8px; padding: 0 15px 30px; }
        .btn-sm { 
            background: #fdfdfd; 
            color: #555; 
            border: 1px solid #e0e0e0; 
            padding: 8px 16px; 
            border-radius: 8px; 
            font-size: 12px; 
            font-weight: 600; 
            cursor: pointer; 
            display: inline-flex; 
            align-items: center; 
            gap: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .btn-sm i { font-size: 14px; }
        .btn-sm.playing { background: var(--red); color: #fff; border-color: var(--red); }

        nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: #fff; border-top: 1px solid #eee; display: flex; justify-content: space-around; z-index: 3000; }
        .nav-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; color: #ccc; font-size: 10px; font-weight: 700; flex: 1; }
        .nav-btn.active { color: var(--gold); }
        .nav-btn i { font-size: 20px; margin-bottom: 4px; }
    </style>
</head>
<body>

<header><div id="tit"></div>Al Quran</header>

<main>
    <div id="m_p" class="p active">
        <div class="grid-main">
            <div class="card" onclick="tab('q')"><i class="fa-solid fa-book-quran"></i><b>Коран</b></div>
            <div class="card" onclick="tab('n')"><i class="fa-solid fa-star"></i><b>99 Имен</b></div>
            <div class="card" onclick="tab('h')"><i class="fa-solid fa-kaaba"></i><b>Хадисы</b></div>
            <div class="card" onclick="tab('s')"><i class="fa-solid fa-sliders"></i><b>Опции</b></div>
        </div>
    </div>

    <div id="q_p" class="p">
        <input type="text" id="search" class="search-box" placeholder="Поиск суры..." onkeyup="filterSurahs()">
        <div id="surahList"></div>
    </div>

    <div id="n_p" class="p">
        <div id="namesList"></div>
    </div>

    <div id="h_p" class="p">
        <div id="hadithList">
            <div class="list-item" style="display:block">
                <p>«Лучший из вас тот, кто лучше всех относится к своей семье»</p>
                <small>— Ат-Тирмизи</small>
            </div>
            <div class="list-item" style="display:block">
                <p>«Поистине, Аллах не смотрит ни на ваше обличие, ни на ваше имущество, но Он смотрит на ваши сердца и ваши дела»</p>
                <small>— Муслим</small>
            </div>
        </div>
    </div>

    <div id="s_p" class="p">
        <div style="background:#fff; padding:20px; border-radius:15px;">
            <h3>Настройки</h3>
            <p>Размер арабского текста:</p>
            <input type="range" min="20" max="55" value="30" style="width:100%" oninput="updateFont(this.value)">
            <p style="margin-top:15px">юзер разработчика в телеграмм: <b>@kyfax</b></p>
        </div>
    </div>
</main>

<div id="reader" class="win">
    <div class="win-head">
        <i class="fa fa-arrow-left" onclick="closeR()" style="font-size:22px; color:var(--gold)"></i>
        <b id="wt"></b>
        <div style="width:22px;"></div>
    </div>
    <div id="wc"></div>
</div>

<nav>
    <div class="nav-btn active" data-tab="m" onclick="tab('m')"><i class="fa fa-home"></i>Дом</div>
    <div class="nav-btn" data-tab="q" onclick="tab('q')"><i class="fa fa-book-open"></i>Коран</div>
    <div class="nav-btn" data-tab="n" onclick="tab('n')"><i class="fa fa-star"></i>Имена</div>
    <div class="nav-btn" data-tab="h" onclick="tab('h')"><i class="fa fa-kaaba"></i>Хадисы</div>
</nav>

<script>
let aud = new Audio(), curFont = 30, allSurahs = [], currentAyahIdx = -1, ayahsData = [];

const namesData = [
    {a:"الرَّحْمَنُ",t:"Ар-Рахман",r:"Милостивый"},{a:"الرَّحِيمُ",t:"Ар-Рахим",r:"Милосердный"},{a:"الْمَلِكُ",t:"Аль-Малик",r:"Царь"},{a:"الْقُدُّوسُ",t:"Аль-Куддус",r:"Святой"},{a:"السَّلَامُ",t:"Ас-Салям",r:"Пречистый"},{a:"الْمُؤْمِنُ",t:"Аль-Мумин",r:"Оберегающий"},{a:"الْمُهَيْمِنُ",t:"Аль-Мухаймин",r:"Хранитель"},{a:"الْعَزِيزُ",t:"Аль-Азиз",r:"Могущественный"},{a:"الْجَبَّارُ",t:"Аль-Джаббар",r:"Могучий"},{a:"الْمُتَكَبِّرُ",t:"Аль-Мутакаббир",r:"Гордый"},
    {a:"الْخَالِقُ",t:"Аль-Халик",r:"Творец"},{a:"الْبَارِئُ",t:"Аль-Бари",r:"Создатель"},{a:"الْمُصَوِّرُ",t:"Аль-Мусаввир",r:"Дарующий облик"},{a:"الْغَفَّارُ",t:"Аль-Гаффар",r:"Прощающий"},{a:"الْقَهَّارُ",t:"Аль-Каххар",r:"Господствующий"},{a:"الْوَهَّابُ",t:"Аль-Ваххаб",r:"Дарующий"},{a:"الرَّزَّاقُ",t:"Ар-Раззак",r:"Наделяющий"},{a:"الْفَتَّاحُ",t:"Аль-Фаттах",r:"Раскрывающий"},{a:"الْعَلِيمُ",t:"Аль-Алим",r:"Всезнающий"},{a:"الْقَابِضُ",t:"Аль-Кабид",r:"Сжимающий"},
    {a:"الْبَاسِطُ",t:"Аль-Басит",r:"Расширяющий"},{a:"الْخَافِضُ",t:"Аль-Хафид",r:"Унижающий"},{a:"الرَّافِعُ",t:"Ар-Рафи",r:"Возвышающий"},{a:"الْمُعِزُّ",t:"Аль-Муизз",r:"Возвеличивающий"},{a:"الْمُذِلُّ",t:"Аль-Музилл",r:"Унижающий"},{a:"السَّمِيعُ",t:"Ас-Сами",r:"Слышащий"},{a:"الْبَصِيرُ",t:"Аль-Басир",r:"Видящий"},{a:"الْحَكَمُ",t:"Аль-Хакам",r:"Судья"},{a:"الْعَدْلُ",t:"Аль-Адль",r:"Справедливый"},{a:"اللَّطِيفُ",t:"Аль-Латиф",r:"Добр"},
    {a:"الْخَبِيرُ",t:"Аль-Хабир",r:"Сведущий"},{a:"الْحَلِيمُ",t:"Аль-Халим",r:"Снисходительный"},{a:"الْعَظِيمُ",t:"Аль-Азым",r:"Великий"},{a:"الْغَفُورُ",t:"Аль-Гафур",r:"Прощающий"},{a:"الشَّكُورُ",t:"Аш-Шакур",r:"Благодарный"},{a:"الْعَلِيُّ",t:"Аль-Али",r:"Высокий"},{a:"الْكَبِيرُ",t:"Аль-Кабир",r:"Великий"},{a:"الْحَفِيظُ",t:"Аль-Хафиз",r:"Хранитель"},{a:"الْمُقِيتُ",t:"Аль-Мукит",r:"Питающий"},{a:"الْحَسِيبُ",t:"Аль-Хасиб",r:"Считающий"},
    {a:"الْجَلِيلُ",t:"Аль-Джалиль",r:"Величественный"},{a:"الْكَرِيمُ",t:"Аль-Карим",r:"Щедрый"},{a:"الرَّقِيبُ",t:"Ар-Ракиб",r:"Следящий"},{a:"الْمُجِيبُ",t:"Аль-Муджиб",r:"Отзывчивый"},{a:"الْوَاسِعُ",t:"Аль-Васи",r:"Объемлющий"},{a:"الْحَكِيمُ",t:"Аль-Хаким",r:"Мудрый"},{a:"الْوَدُودُ",t:"Аль-Вадуд",r:"Любящий"},{a:"الْمَجِيدُ",t:"Аль-Маджид",r:"Славный"},{a:"الْبَاعِثُ",t:"Аль-Баис",r:"Воскрешающий"},{a:"الشَّهِيدُ",t:"Аш-Шахид",r:"Свидетель"},
    {a:"الْحَقُّ",t:"Аль-Хакк",r:"Истина"},{a:"الْوَكِيلُ",t:"Аль-Вакиль",r:"Попечитель"},{a:"الْقَوِيُّ",t:"Аль-Кави",r:"Сильный"},{a:"الْمَتِينُ",t:"Аль-Матин",r:"Прочный"},{a:"الْوَلِيُّ",t:"Аль-Вали",r:"Покровитель"},{a:"الْحَمِيدُ",t:"Аль-Хамид",r:"Достохвальный"},{a:"الْمُحْصِي",t:"Аль-Мухси",r:"Учитывающий"},{a:"الْمُبْدِئُ",t:"Аль-Мубди",r:"Начинающий"},{a:"الْمُعِيدُ",t:"Аль-Муид",r:"Возвращающий"},{a:"الْمُحْيِي",t:"Аль-Мухйи",r:"Оживляющий"},
    {a:"الْمُمِيتُ",t:"Аль-Мумит",r:"Умерщвляющий"},{a:"الْحَيُّ",t:"Аль-Хай",r:"Живой"},{a:"الْقَيُّومُ",t:"Аль-Кайюм",r:"Самосущий"},{a:"الْوَاجِدُ",t:"Аль-Ваджид",r:"Находящий"},{a:"الْمَاجِدُ",t:"Аль-Маджид",r:"Славный"},{a:"الْوَاحِدُ",t:"Аль-Вахид",r:"Единственный"},{a:"الأَحَدُ",t:"Аль-Ахад",r:"Единый"},{a:"الصَّمَدُ",t:"Ас-Самад",r:"Самодостаточный"},{a:"الْقَادِرُ",t:"Аль-Кадир",r:"Могучий"},{a:"الْمُقْتَدِرُ",t:"Аль-Муктадир",r:"Всемогущий"},
    {a:"الْمُقَدِّمُ",t:"Аль-Мукаддим",r:"Приближающий"},{a:"الْمُؤَخِّрُ",t:"Аль-Муаххир",r:"Отдаляющий"},{a:"الأَوَّلُ",t:"Аль-Авваль",r:"Первый"},{a:"الآخِرُ",t:"Аль-Ахир",r:"Последний"},{a:"الظَّاهِرُ",t:"Аз-Захир",r:"Явный"},{a:"الْبَاطِنُ",t:"Аль-Батин",r:"Скрытый"},{a:"الْوَالِي",t:"Аль-Вали",r:"Правящий"},{a:"الْمُتَعَالِي",t:"Аль-Мутаали",r:"Превознесенный"},{a:"الْبَرُّ",t:"Аль-Барр",r:"Благостный"},{a:"التَّوَّابُ",t:"Ат-Тавваб",r:"Принимающий"},
    {a:"الْمُنْتَقِمُ",t:"Аль-Мунтаким",r:"Мстящий"},{a:"الْعَفُوُّ",t:"Аль-Афувв",r:"Прощающий"},{a:"الرَّؤُوفُ",t:"Ар-Рауф",r:"Сострадательный"},{a:"مَالِكُ الْمُلْكِ",t:"Малику-ль-Мульк",r:"Царь царства"},{a:"ذُو الْجَلَالِ وَالإِكْرَامِ",t:"Зуль-Джаляль",r:"Обладатель величия"},{a:"الْمُقْسِطُ",t:"Аль-Муксит",r:"Справедливый"},{a:"الْجَامِعُ",t:"Аль-Джами",r:"Собирающий"},{a:"الْغَنِيُّ",t:"Аль-Гани",r:"Богатый"},{a:"الْمُغْنِي",t:"Аль-Мугни",r:"Обогащающий"},{a:"الْمَانِعُ",t:"Аль-Мани",r:"Удерживающий"},
    {a:"الضَّارُّ",t:"Ад-Дарр",r:"Вредящий"},{a:"النَّافِعُ",t:"Ан-Нафи",r:"Благотворящий"},{a:"النُّورُ",t:"Ан-Нур",r:"Свет"},{a:"الْهَادِي",t:"Аль-Хади",r:"Наставляющий"},{a:"الْبَدِيعُ",t:"Аль-Бади",r:"Творец"},{a:"الْبَاقِي",t:"Аль-Баки",r:"Вечный"},{a:"الْوَارِثُ",t:"Аль-Варис",r:"Наследник"},{a:"الرَّشِيدُ",t:"Ар-Рашид",r:"Правильный"},{a:"الصَّبُورُ",t:"Ас-Сабур",r:"Терпеливый"}
];

const ruSurahNames = ["Аль-Фатиха","Аль-Бакара","Али Имран","Ан-Ниса","Аль-Маида","Аль-Анам","Аль-Араф","Аль-Анфаль","Ат-Тауба","Юнус","Худ","Юсуф","Ар-Раад","Ибрахим","Аль-Хиджр","Ан-Нахль","Аль-Исра","Аль-Кахф","Марьям","Та Ха","Аль-Анбия","Аль-Хадж","Аль-Муминун","Ан-Нур","Аль-Фуркан","Аш-Шуара","Ан-Намль","Аль-Касас","Аль-Анкабут","Ар-Рум","Лукман","Ас-Сажда","Аль-Ахзаб","Саба","Фатыр","Ясин","Ас-Саффат","Сад","Аз-Зумар","Гафир","Фуссылат","Аш-Шура","Аз-Зухруф","Ад-Духан","Аль-Джасия","Аль-Ахкаф","Мухаммад","Аль-Фатх","Аль-Худжурат","Каф","Ад-Зарийят","Ат-Тур","Ан-Наджм","Аль-Камар","Ар-Рахман","Аль-Вакиа","Аль-Хадид","Аль-Муджадила","Аль-Хашр","Аль-Мумтахана","Ас-Сафф","Аль-Джумуа","Аль-Мунафикун","Ат-Тагабун","Ат-Таляк","Ат-Тахрим","Аль-Мульк","Аль-Калям","Аль-Хакка","Аль-Мааридж","Нух","Аль-Джинн","Аль-Муззаммиль","Аль-Муддассир","Аль-Кыйяма","Аль-Инсан","Аль-Мурсалят","Ан-Наба","Ан-Назиат","Абаса","Ат-Таквир","Аль-Инфитар","Аль-Мутаффифин","Аль-Иншикак","Аль-Бурудж","Ат-Тарик","Аль-Аля","Аль-Гашия","Аль-Фаджр","Аль-Баляд","Аш-Шамс","Аль-Лайл","Ад-Духа","Аш-Шарх","Ат-Тин","Аль-Аляк","Аль-Кадр","Аль-Байина","Аз-Залзаля","Аль-Адият","Аль-Кариа","Ат-Такасур","Аль-Аср","Аль-Хумаза","Аль-Филь","Курайш","Аль-Маун","Аль-Каусар","Аль-Кафирун","Ан-Наср","Аль-Масад","Аль-Ихляс","Аль-Фаляк","Ан-Нас"];

function tab(p) {
    document.querySelectorAll('.p, .nav-btn').forEach(x => x.classList.remove('active'));
    document.getElementById(p+'_p').classList.add('active');
    let b = document.querySelector(`[data-tab="${p}"]`);
    if(b) b.classList.add('active');
}

function filterSurahs() {
    let val = document.getElementById('search').value.toLowerCase();
    renderList(allSurahs.filter((s, i) => ruSurahNames[i].toLowerCase().includes(val)));
}

function renderList(list) {
    document.getElementById('surahList').innerHTML = list.map(s => `
        <div class="list-item" onclick="openR(${s.number}, '${ruSurahNames[s.number-1]}')">
            <b>${s.number}. ${ruSurahNames[s.number-1]}</b>
            <span style="font-family:'Amiri'; color:var(--gold); font-size:18px;">${s.name}</span>
        </div>`).join('');
}

async function openR(id, name) {
    document.getElementById('reader').style.display = 'block';
    document.getElementById('wt').innerText = name;
    document.getElementById('wc').innerHTML = "<center style='padding:50px;'>Загрузка...</center>";
    try {
        const res = await fetch(`https://api.alquran.cloud/v1/surah/${id}/editions/quran-uthmani,ru.kuliev,ru.muntahab`);
        const data = await res.json();
        ayahsData = data.data[0].ayahs;
        let trans = data.data[1].ayahs;
        let tafsir = data.data[2].ayahs;
        
        let html = (id != 1 && id != 9) ? `<div class="art" style="text-align:center; color:var(--gold);">بِسْمِ ٱللَّهِ ٱلرَّحْمَـٰنِ ٱلرَّحِيمِ</div>` : "";
        ayahsData.forEach((a, i) => {
            let txt = a.text;
            if (i === 0 && id != 1) {
                if (id == 9) txt = txt.replace("بِسْمِ ٱللَّهِ ٱلرَّحْمَـٰنِ ٱلرَّحِيمِ", "").trim();
                else { let w = txt.split(' '); if (w.length > 4) txt = w.slice(4).join(' '); }
            }
            html += `
            <div id="a-block-${i}">
                <div class="art" style="font-size:${curFont}px">${txt} <span class="sup-num">${i+1}</span></div>
                <div class="rut"><b>${i+1}.</b> ${trans[i].text}</div>
                <div id="taf-box-${i}" class="taf-box"><b>Толкование:</b><br>${tafsir[i].text}</div>
                <div class="btns-row">
                    <button id="p-btn-${i}" class="btn-sm" onclick="togglePlay(${i})"><i class="fa fa-play"></i> Слушать</button>
                    <button class="btn-sm" onclick="togTaf(${i})"><i class="fa fa-book-open"></i> Тафсир</button>
                </div>
            </div>`;
        });
        document.getElementById('wc').innerHTML = html;
    } catch(e) { document.getElementById('wc').innerHTML = "Ошибка!"; }
}

function togTaf(i) {
    let t = document.getElementById(`taf-box-${i}`);
    t.style.display = t.style.display === 'block' ? 'none' : 'block';
}

function togglePlay(idx) {
    let btn = document.getElementById(`p-btn-${idx}`);
    if (currentAyahIdx === idx && !aud.paused) {
        stopAll();
    } else {
        stopAll();
        currentAyahIdx = idx;
        btn.classList.add('playing');
        btn.innerHTML = "<i class='fa fa-stop'></i> СТОП";
        aud.src = `https://cdn.islamic.network/quran/audio/128/ar.alafasy/${ayahsData[idx].number}.mp3`;
        aud.play();
    }
}

function stopAll() {
    aud.pause();
    document.querySelectorAll('.btn-sm').forEach(b => {
        b.classList.remove('playing');
        if (b.id.startsWith('p-btn-')) b.innerHTML = "<i class='fa fa-play'></i> Слушать";
    });
}

aud.onended = () => { if (currentAyahIdx < ayahsData.length - 1) togglePlay(currentAyahIdx + 1); else stopAll(); };
function closeR() { stopAll(); document.getElementById('reader').style.display='none'; }
function updateFont(v) { curFont = v; document.querySelectorAll('.art').forEach(el => el.style.fontSize = v + 'px'); }

window.onload = () => {
    document.getElementById('namesList').innerHTML = namesData.map((n, i) => `
        <div class="list-item">
            <div><b>${i+1}. ${n.t}</b><br><small>${n.r}</small></div>
            <span style="font-family:'Amiri'; color:var(--gold); font-size:22px;">${n.a}</span>
        </div>`).join('');
    fetch("https://api.alquran.cloud/v1/surah").then(r => r.json()).then(d => { allSurahs = d.data; renderList(allSurahs); });
};
</script>
</body>
</html>

